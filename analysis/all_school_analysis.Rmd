---
title: "Title Goes Here"
author: "Names Go Here" 
output:
  html_document:
    theme: cerulean
    code_folding: hide
    toc: true
    toc_float: true
    toc_depth: 3
    df_print: paged
  md_document:
    variant: markdown_github
    toc: true
    toc_depth: 3
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## Introduction
This data notebook contains the analysis that generated facts in the story ["Title"]() from the series ["Series"](). For each sentence in the story generated by original data analysis, we have provided the corresponding code and results.

## Load Libraries, Settings and Global Functions
```{r warning=FALSE,error=FALSE,message=FALSE}
# For general data science
library(tidyverse)

# For data cleaning
library(janitor)

# For loading Excel files
library(readxl)

# For working with datetime
library(lubridate)

# For U.S. Census Bureau data
# library(tigris)

# For pretty tables
library(kableExtra)
library(knitr)

## Functions 

# Function for formatted table output

output_formatted_table = function(table, text){
  
  table %>% 
    kable(caption = text) %>%
    kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), font_size = 14, fixed_thead = T) %>%
    scroll_box(width = "100%")
}


```
# Thoughts
- The data could probably use open refine for location columns for example
- These universities do no report race or gender in police reports published to the public: george town, george washington, or howard. UMD does, why is this?




## Load Data

```{r}

# Load GT
etl_gt = readRDS("../data/processed/etl_gt_incident_log.rds")


# Load GWU
etl_gwu = readRDS("../data/processed/etl_gwu_incident_log.rds")


# Load Howard

etl_howard = readRDS("../data/processed/etl_howard_incident_log.rds")


# Load UMD
etl_umd_incident = readRDS("../data/processed/etl_umd_police_incident_data.rds")

etl_umd_arrest = readRDS("../data/processed/etl_umd_police_arrest_data.rds")


# Load GMU







```

##  Category break down

```{r}

# GT Category Breakdown
gt_incident_summary = etl_gt %>% 
  group_by(incident) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

## GWU Category Breakdown
gwu_incident_summary = etl_gwu %>% 
  group_by(nature_classification) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

## Howard Category Breakdown
howard_incident_summary = etl_howard %>% 
  group_by(natures_of_crimes) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

## UMD Incident Breakdown
umd_incident_summary = etl_umd_incident %>% 
  group_by() %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))



## UMD Arrest Breakdown


  


```

## UMD
- 


```{r}
t = etl_umd_arrest

--
# incident type by year chart
gt_incident_type_over_the_years = etl_gt %>% 
  group_by(incident, year_occured) %>% 
  summarise(count = n())
ls_gt_incidents = unique(gt_incident_type_over_the_years$incident)
for (type in ls_gt_incidents){
  plot1 = gt_incident_type_over_the_years %>% 
  filter(incident == type) %>% 
  ggplot(aes(x = year_occured, y = count))+
  geom_line()+
  ggtitle(paste0(type, " over the years at George Town"))
  
  print(plot1)
}

--

  # incident type by year chart
umd_arrests_type_over_the_years = etl_umd_arrest %>% 
  group_by(sex, date) %>% 
  summarise(count = n())

umd_sex_type = unique(etl_umd_arrest$sex)



for (type in umd_sex_type){
  plot1 = umd_arrests_type_over_the_years %>% 
  filter(sex == type) %>% 
  ggplot(aes(x = date, y = count))+
  geom_line()+
  ggtitle(paste0(type, " over the years at UMD"))
  
  print(plot1)
}

md_sex_type  
```

## GWU
- GWU only have 2021-2021 data, we  should ask for their data
- At least 84 percent of responses happen on campus
- 7 eleven at mitchell hall seems to be a hot location
- At mitchel hall 7 eleven store 67 percent of cases have been related to theft there

```{r}

# What percent of cases were off campus?

gwu_on_off_campus = etl_gwu %>% 
  group_by(off_campus_y_or_n) %>% 
  summarise(count = n())

# What are the break down of type of cases handled off campus
gwu_off_campus_type = etl_gwu %>% 
  filter (off_campus_y_or_n == "N") %>% 
  group_by(nature_classification) %>% 
  summarise(count = n())

# Where do these happen on campus?
gwu_location_summaries = etl_gwu %>% 
  group_by(general_location) %>% 
  summarise(count = n())

# What are police responding to at mitchell hall 7-11
gwu_7_eleven = etl_gwu %>% 
  mutate(general_location = str_squish(general_location)) %>% 
  filter(general_location == "Mitchell Hall (7-Eleven Store)") %>% 
  group_by(nature_classification) %>% 
  summarise(count = n())

```


## GT
- Most police responses happen at lxr, a resident building
- At lxr, most commons calls over the years are drug violations, then theft, then alcohol violations
- Assault spike in 2018
- burglary drop in 2021-2021 , probably because less people on campus
- destruction of property spike in 2018
- drug violation has steadily gone down over the years
- reported sexual assault spike in 2019, has gone down since
- stalking spike in 2019
- theft decreased, probably because of pandemic
- unlawful entry spike in 2019

```{r}

# Where do crimes tend to happen on campus
gt_location_summaries = etl_gt %>% 
  group_by(general_location) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

# What type happen most at lxr, the residential building
gt_lxr_summaries = etl_gt %>% 
  filter(general_location == "lxr") %>% 
  group_by(incident) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

# incident type by year chart
gt_incident_type_over_the_years = etl_gt %>% 
  group_by(incident, year_occured) %>% 
  summarise(count = n())
ls_gt_incidents = unique(gt_incident_type_over_the_years$incident)
for (type in ls_gt_incidents){
  plot1 = gt_incident_type_over_the_years %>% 
  filter(incident == type) %>% 
  ggplot(aes(x = year_occured, y = count))+
  geom_line()+
  ggtitle(paste0(type, " over the years at George Town"))
  
  print(plot1)
}
```

## Howard University
- Howard has a lot of sick transports

```{r}


```




## For Facts in a story

### Header

#### Subheader

```{r warning=FALSE,error=FALSE,message=FALSE}



```

## Analysis

### FACT: 

#### Explanation

#### Supporting code and output
```{r warning=FALSE,error=FALSE,message=FALSE}

```

-30-

